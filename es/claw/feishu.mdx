---
title: "Feishu / Lark"
description: "Conecta tu instancia de Claw a Feishu (Lark) utilizando eventos de WebSocket"
---

Conecta Feishu (飞书) o Lark a tu instancia de Claw. Utiliza el modo WebSocket — no se requiere una URL de callback pública.

## Requisitos previos

- Una cuenta de [Feishu](https://www.feishu.cn/) o [Lark](https://www.larksuite.com/) con acceso de desarrollador
- Una instancia de Claw ([crea una aquí](https://lemondata.cc/dashboard/claw))

## Guía de configuración

<Steps>
  <Step title="Crear una aplicación de Feishu">
    1. Ve a [Feishu Open Platform](https://open.feishu.cn/app) (o [Lark Developer](https://open.larksuite.com/app))
    2. Haz clic en **Create Custom App**
    3. Ingresa un nombre y descripción para la aplicación
    4. Haz clic en **Create**
  </Step>
  <Step title="Agregar capacidad de Bot">
    1. En la configuración de tu aplicación, ve a **Features** → **Bot**
    2. Habilita la capacidad de bot
    3. Esto permite que tu aplicación reciba y envíe mensajes
  </Step>
  <Step title="Obtener credenciales">
    1. Ve a **Credentials & Basic Info**
    2. Copia el **App ID** (comienza con `cli_`)
    3. Copia el **App Secret**
  </Step>
  <Step title="Configurar la suscripción de eventos">
    1. Ve a **Event Subscriptions**
    2. Selecciona el modo **WebSocket** (recomendado — no se requiere una URL pública)
    3. Si se te solicita, establece el **Encrypt Key** y el **Verification Token**

    <Tip>
    Cuando configuras Feishu en el dashboard de LemonData, el Encrypt Key y el Verification Token se **generan automáticamente** para ti. Copia estos valores en la consola de desarrollador de Feishu.
    </Tip>
  </Step>
  <Step title="Agregar permisos de eventos">
    1. En Event Subscriptions, agrega estos eventos:
       - `im.message.receive_v1` — Recibir mensajes
    2. Ve a **Permissions & Scopes** y agrega:
       - `im:message` — Enviar y recibir mensajes
       - `im:message.group_at_msg` — Recibir menciones @ en grupos
    3. Haz clic en **Save**
  </Step>
  <Step title="Publicar la aplicación">
    1. Ve a **App Release** → **Version Management**
    2. Crea una nueva versión
    3. Envía para revisión (para aplicaciones internas, esto suele ser instantáneo)
    4. Una vez aprobada, la aplicación estará activa
  </Step>
  <Step title="Configurar en el Dashboard de LemonData">
    1. Ve a tu [Claw Dashboard](https://lemondata.cc/dashboard/claw)
    2. Haz clic en el **icono de configuración** de tu instancia
    3. Abre la pestaña **IM Integrations**
    4. Expande la sección **Feishu**
    5. Pega tu **App ID** y **App Secret**
    6. Copia el **Encrypt Key** y el **Verification Token** generados automáticamente de vuelta a la consola de desarrollador de Feishu
    7. Haz clic en **Save**
  </Step>
  <Step title="Comenzar a chatear">
    1. En Feishu, busca tu bot por su nombre
    2. Envíale un mensaje
    3. ¡El primer usuario se **vincula automáticamente** como propietario — no se requiere código!
    4. ¡Comienza a chatear con la IA!
  </Step>
</Steps>

## Configuración de grupo

Configura el comportamiento del chat grupal en la pestaña **IM Integrations** de tu Dashboard:

| Configuración | Opciones | Descripción |
|---------|---------|-------------|
| **Group Policy** | Open (predeterminado) / Allowlist / Disabled | Controla quién puede activar el bot en los grupos |
| **Require @mention** | Activado / Desactivado | El bot solo responde cuando es mencionado con @ |
| **Group IDs** | Lista de IDs de chat | Restringir a grupos específicos (vacío = todos los grupos) |
| **Group Allowed Users** | Lista de Open IDs | Solo estos usuarios pueden activar el bot (modo allowlist) |

## Solución de problemas

<AccordionGroup>
  <Accordion title="El bot no recibe mensajes">
    - Verifica que la aplicación esté publicada y aprobada
    - Comprueba que el evento `im.message.receive_v1` esté suscrito
    - Asegúrate de que el modo WebSocket esté seleccionado (no HTTP)
    - Verifica que el Encrypt Key y el Verification Token coincidan entre la consola de Feishu y la configuración de Claw
  </Accordion>
  <Accordion title="Error 'app_ticket'">
    - Esto suele significar que el App ID o el App Secret son incorrectos
    - Verifica nuevamente las credenciales en tu dashboard
  </Accordion>
</AccordionGroup>