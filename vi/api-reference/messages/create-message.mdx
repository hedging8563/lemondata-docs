---
title: "Tạo Tin nhắn"
openapi: "POST /v1/messages"
description: "Tạo một tin nhắn bằng định dạng Anthropic Messages API"
---

## Xác thực

<ParamField header="Authorization" type="string" required>
  Token Bearer để xác thực API. Định dạng: `Bearer sk-your-api-key`
</ParamField>

## Tổng quan

Endpoint này cung cấp khả năng tương thích gốc với Anthropic Messages API. Sử dụng endpoint này cho các mô hình Claude với các tính năng như suy nghĩ mở rộng (extended thinking).

<Note>
Base URL cho Anthropic SDK: `https://api.lemondata.cc` (không có hậu tố `/v1`)
</Note>

## Request Headers

<ParamField header="x-api-key" type="string" required>
  API key LemonData của bạn. Giải pháp thay thế cho Bearer token.
</ParamField>

<ParamField header="anthropic-version" type="string" required>
  Phiên bản Anthropic API. Sử dụng `2023-06-01`.
</ParamField>

## Request Body

<ParamField body="model" type="string" required>
  ID mô hình Claude (ví dụ: `claude-sonnet-4-5`).
</ParamField>

<ParamField body="messages" type="array" required>
  Mảng các đối tượng tin nhắn với `role` và `content`.
</ParamField>

<ParamField body="max_tokens" type="integer" required>
  Số lượng token tối đa để tạo.
</ParamField>

<ParamField body="system" type="string">
  System prompt (tách biệt với mảng messages).
</ParamField>

<ParamField body="temperature" type="number" default="1">
  Nhiệt độ lấy mẫu (0-1).
</ParamField>

<ParamField body="stream" type="boolean" default="false">
  Bật phản hồi dạng luồng (streaming).
</ParamField>

<ParamField body="thinking" type="object">
  Cấu hình suy nghĩ mở rộng (Claude Opus 4.5).

  - `type` (string): `"enabled"` để kích hoạt
  - `budget_tokens` (integer): Ngân sách token cho việc suy nghĩ
</ParamField>

<ParamField body="tools" type="array">
  Các công cụ có sẵn cho mô hình.
</ParamField>

<ParamField body="tool_choice" type="object">
  Cách mô hình nên sử dụng các công cụ. Các tùy chọn: `auto`, `any`, `tool` (công cụ cụ thể).
</ParamField>

<ParamField body="top_p" type="number">
  Tham số lấy mẫu hạt nhân (nucleus sampling). Sử dụng temperature hoặc top_p, không sử dụng cả hai.
</ParamField>

<ParamField body="top_k" type="integer">
  Chỉ lấy mẫu từ K tùy chọn hàng đầu cho mỗi token.
</ParamField>

<ParamField body="stop_sequences" type="array">
  Các chuỗi dừng tùy chỉnh sẽ khiến mô hình ngừng tạo nội dung.
</ParamField>

<ParamField body="metadata" type="object">
  Metadata để đính kèm vào yêu cầu cho mục đích theo dõi.
</ParamField>

## Phản hồi

<ResponseField name="id" type="string">
  Định danh tin nhắn duy nhất.
</ResponseField>

<ResponseField name="type" type="string">
  Luôn là `message`.
</ResponseField>

<ResponseField name="role" type="string">
  Luôn là `assistant`.
</ResponseField>

<ResponseField name="content" type="array">
  Mảng các khối nội dung (text, thinking, tool_use).
</ResponseField>

<ResponseField name="model" type="string">
  Mô hình được sử dụng.
</ResponseField>

<ResponseField name="stop_reason" type="string">
  Lý do việc tạo nội dung dừng lại (`end_turn`, `max_tokens`, `tool_use`).
</ResponseField>

<ResponseField name="usage" type="object">
  Mức sử dụng token với `input_tokens` và `output_tokens`.
</ResponseField>

<RequestExample>
```bash cURL
curl -X POST "https://api.lemondata.cc/v1/messages" \
  -H "x-api-key: sk-your-api-key" \
  -H "anthropic-version: 2023-06-01" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "claude-sonnet-4-5",
    "max_tokens": 1024,
    "system": "You are a helpful assistant.",
    "messages": [
      {"role": "user", "content": "Hello, Claude!"}
    ]
  }'
```

```python Python
from anthropic import Anthropic

client = Anthropic(
    api_key="sk-your-api-key",
    base_url="https://api.lemondata.cc"
)

message = client.messages.create(
    model="claude-sonnet-4-5",
    max_tokens=1024,
    system="You are a helpful assistant.",
    messages=[
        {"role": "user", "content": "Hello, Claude!"}
    ]
)

print(message.content[0].text)
```

```javascript JavaScript
import Anthropic from '@anthropic-ai/sdk';

const client = new Anthropic({
  apiKey: 'sk-your-api-key',
  baseURL: 'https://api.lemondata.cc'
});

const message = await client.messages.create({
  model: 'claude-sonnet-4-5',
  max_tokens: 1024,
  system: 'You are a helpful assistant.',
  messages: [
    { role: 'user', content: 'Hello, Claude!' }
  ]
});

console.log(message.content[0].text);
```

```go Go
package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "io"
    "net/http"
)

func main() {
    payload := map[string]interface{}{
        "model":      "claude-sonnet-4-5",
        "max_tokens": 1024,
        "system":     "You are a helpful assistant.",
        "messages": []map[string]string{
            {"role": "user", "content": "Hello, Claude!"},
        },
    }

    jsonData, _ := json.Marshal(payload)
    req, _ := http.NewRequest("POST", "https://api.lemondata.cc/v1/messages", bytes.NewBuffer(jsonData))
    req.Header.Set("x-api-key", "sk-your-api-key")
    req.Header.Set("anthropic-version", "2023-06-01")
    req.Header.Set("Content-Type", "application/json")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()

    body, _ := io.ReadAll(resp.Body)
    fmt.Println(string(body))
}
```

```php PHP
<?php
$payload = [
    'model' => 'claude-sonnet-4-5',
    'max_tokens' => 1024,
    'system' => 'You are a helpful assistant.',
    'messages' => [
        ['role' => 'user', 'content' => 'Hello, Claude!']
    ]
];

$ch = curl_init('https://api.lemondata.cc/v1/messages');

curl_setopt_array($ch, [
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_POST => true,
    CURLOPT_HTTPHEADER => [
        'x-api-key: sk-your-api-key',
        'anthropic-version: 2023-06-01',
        'Content-Type: application/json'
    ],
    CURLOPT_POSTFIELDS => json_encode($payload)
]);

$response = curl_exec($ch);
curl_close($ch);

$data = json_decode($response, true);
echo $data['content'][0]['text'];
```
</RequestExample>

<ResponseExample>
```json Response
{
  "id": "msg_abc123",
  "type": "message",
  "role": "assistant",
  "content": [
    {
      "type": "text",
      "text": "Hello! How can I help you today?"
    }
  ],
  "model": "claude-sonnet-4-5",
  "stop_reason": "end_turn",
  "usage": {
    "input_tokens": 15,
    "output_tokens": 10
  }
}
```
</ResponseExample>

## Ví dụ về Suy nghĩ Mở rộng

```python
message = client.messages.create(
    model="claude-opus-4-5",
    max_tokens=16000,
    thinking={
        "type": "enabled",
        "budget_tokens": 10000
    },
    messages=[{"role": "user", "content": "Solve this math problem..."}]
)

for block in message.content:
    if block.type == "thinking":
        print(f"Thinking: {block.thinking}")
    elif block.type == "text":
        print(f"Response: {block.text}")
```