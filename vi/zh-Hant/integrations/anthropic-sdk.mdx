---
title: "Anthropic SDK"
description: "Sử dụng LemonData với Anthropic SDK để truy cập các mô hình Claude"
---

## Tổng quan

LemonData hỗ trợ định dạng Anthropic Messages API gốc. Vui lòng sử dụng Anthropic SDK chính thức với LemonData để truy cập các mô hình Claude.

## Cài đặt

<CodeGroup>

```bash Python
pip install anthropic
```

```bash Node.js
npm install @anthropic-ai/sdk
```

</CodeGroup>

## Cấu hình

<CodeGroup>

```python Python
from anthropic import Anthropic

client = Anthropic(
    api_key="sk-your-lemondata-key",
    base_url="https://api.lemondata.cc"
)
```

```javascript JavaScript
import Anthropic from '@anthropic-ai/sdk';

const client = new Anthropic({
  apiKey: 'sk-your-lemondata-key',
  baseURL: 'https://api.lemondata.cc'
});
```

</CodeGroup>

<Note>
  Lưu ý: Base URL của Anthropic SDK là `https://api.lemondata.cc` (không bao gồm `/v1`).
</Note>

## Cách sử dụng cơ bản

```python
message = client.messages.create(
    model="claude-sonnet-4-5",
    max_tokens=1024,
    messages=[
        {"role": "user", "content": "Hello, Claude!"}
    ]
)

print(message.content[0].text)
```

## Sử dụng System Prompt

```python
message = client.messages.create(
    model="claude-sonnet-4-5",
    max_tokens=1024,
    system="You are a helpful coding assistant.",
    messages=[
        {"role": "user", "content": "Write a Python function to reverse a string"}
    ]
)
```

## Streaming (Truyền phát)

```python
with client.messages.stream(
    model="claude-sonnet-4-5",
    max_tokens=1024,
    messages=[{"role": "user", "content": "Tell me a story"}]
) as stream:
    for text in stream.text_stream:
        print(text, end="", flush=True)
```

## Thị giác (Vision)

```python
import base64

# From URL
message = client.messages.create(
    model="claude-sonnet-4-5",
    max_tokens=1024,
    messages=[{
        "role": "user",
        "content": [
            {"type": "text", "text": "What's in this image?"},
            {
                "type": "image",
                "source": {
                    "type": "url",
                    "url": "https://example.com/image.jpg"
                }
            }
        ]
    }]
)

# From base64
with open("image.png", "rb") as f:
    image_data = base64.b64encode(f.read()).decode()

message = client.messages.create(
    model="claude-sonnet-4-5",
    max_tokens=1024,
    messages=[{
        "role": "user",
        "content": [
            {"type": "text", "text": "Describe this image"},
            {
                "type": "image",
                "source": {
                    "type": "base64",
                    "media_type": "image/png",
                    "data": image_data
                }
            }
        ]
    }]
)
```

## Sử dụng công cụ (Tool Use)

```python
message = client.messages.create(
    model="claude-sonnet-4-5",
    max_tokens=1024,
    tools=[{
        "name": "get_weather",
        "description": "Get the weather for a location",
        "input_schema": {
            "type": "object",
            "properties": {
                "location": {"type": "string", "description": "City name"}
            },
            "required": ["location"]
        }
    }],
    messages=[{"role": "user", "content": "What's the weather in Tokyo?"}]
)

# Check for tool use
for block in message.content:
    if block.type == "tool_use":
        print(f"Tool: {block.name}")
        print(f"Input: {block.input}")
```

## Suy nghĩ mở rộng (Extended Thinking) (Claude Opus 4.5)

Áp dụng cho các mô hình hỗ trợ suy nghĩ mở rộng:

```python
message = client.messages.create(
    model="claude-opus-4-5",
    max_tokens=16000,
    thinking={
        "type": "enabled",
        "budget_tokens": 10000
    },
    messages=[{"role": "user", "content": "Solve this complex math problem..."}]
)

# Access thinking blocks
for block in message.content:
    if block.type == "thinking":
        print(f"Thinking: {block.thinking}")
    elif block.type == "text":
        print(f"Response: {block.text}")
```

## Các mô hình Claude hiện có

| Mô hình | Phù hợp nhất |
|-------|----------|
| `claude-opus-4-5` | Suy luận phức tạp, suy nghĩ mở rộng |
| `claude-sonnet-4-5` | Mục đích tổng quát, lập trình |
| `claude-haiku-4-5` | Phản hồi nhanh |

## Xử lý lỗi

```python
from anthropic import APIError, APIStatusError, APIConnectionError

try:
    message = client.messages.create(
        model="claude-sonnet-4-5",
        max_tokens=1024,
        messages=[{"role": "user", "content": "Hello"}]
    )
except APIStatusError as e:
    if e.status_code == 401:
        print("Invalid API key")
    elif e.status_code == 429:
        print("Rate limit exceeded")
    else:
        print(f"API error: {e.status_code}")
except APIConnectionError:
    print("Connection error")
except APIError as e:
    print(f"Unexpected error: {e}")
```

## So sánh: OpenAI SDK vs Anthropic SDK

Cả hai đều có thể được sử dụng với LemonData cho các mô hình Claude:

| Tính năng | OpenAI SDK | Anthropic SDK |
|---------|-----------|---------------|
| Base URL | `https://api.lemondata.cc/v1` | `https://api.lemondata.cc` |
| Endpoint | `/chat/completions` | `/v1/messages` |
| System prompt | Trong mảng `messages` | Tham số `system` độc lập |
| Suy nghĩ mở rộng (Extended thinking) | Không hỗ trợ | Hỗ trợ |

Vui lòng chọn dựa trên sở thích hoặc cơ sở mã hiện tại của bạn.