---
title: "Feishu / Lark"
description: "Connect your Claw instance to Feishu (Lark) using WebSocket events"
---

Connect Feishu (飞书) or Lark to your Claw instance. Uses WebSocket mode — no public callback URL needed.

## Prerequisites

- A [Feishu](https://www.feishu.cn/) or [Lark](https://www.larksuite.com/) account with developer access
- A Claw instance ([create one here](https://lemondata.cc/dashboard/claw))

## Setup Guide

<Steps>
  <Step title="Create a Feishu App">
    1. Go to [Feishu Open Platform](https://open.feishu.cn/app) (or [Lark Developer](https://open.larksuite.com/app))
    2. Click **Create Custom App**
    3. Enter an app name and description
    4. Click **Create**
  </Step>
  <Step title="Add Bot Capability">
    1. In your app settings, go to **Features** → **Bot**
    2. Enable the bot capability
    3. This allows your app to receive and send messages
  </Step>
  <Step title="Get Credentials">
    1. Go to **Credentials & Basic Info**
    2. Copy the **App ID** (starts with `cli_`)
    3. Copy the **App Secret**
  </Step>
  <Step title="Configure Event Subscription">
    1. Go to **Event Subscriptions**
    2. Select **WebSocket** mode (recommended — no public URL needed)
    3. If prompted, set the **Encrypt Key** and **Verification Token**

    <Tip>
    When you configure Feishu in the LemonData dashboard, Encrypt Key and Verification Token are **auto-generated** for you. Copy these values into the Feishu developer console.
    </Tip>
  </Step>
  <Step title="Add Event Permissions">
    1. Under Event Subscriptions, add these events:
       - `im.message.receive_v1` — Receive messages
    2. Go to **Permissions & Scopes** and add:
       - `im:message` — Send and receive messages
       - `im:message.group_at_msg` — Receive group @mentions
    3. Click **Save**
  </Step>
  <Step title="Publish the App">
    1. Go to **App Release** → **Version Management**
    2. Create a new version
    3. Submit for review (for internal apps, this is usually instant)
    4. Once approved, the app is live
  </Step>
  <Step title="Configure in LemonData Dashboard">
    1. Go to your [Claw Dashboard](https://lemondata.cc/dashboard/claw)
    2. Click the **settings icon** on your instance
    3. Open the **IM Integrations** tab
    4. Expand the **Feishu** section
    5. Paste your **App ID** and **App Secret**
    6. Copy the auto-generated **Encrypt Key** and **Verification Token** back to the Feishu developer console
    7. Click **Save**
  </Step>
  <Step title="Start Chatting">
    1. In Feishu, search for your bot by name
    2. Send it a message
    3. Complete the pairing process
    4. Start chatting with AI!
  </Step>
</Steps>

## Group Settings

Configure group chat behavior in the **IM Integrations** tab of your Dashboard:

| Setting | Options | Description |
|---------|---------|-------------|
| **Group Policy** | Open (default) / Allowlist / Disabled | Controls who can trigger the bot in groups |
| **Require @mention** | On / Off | Bot only responds when @mentioned |
| **Group IDs** | List of chat IDs | Restrict to specific groups (empty = all groups) |
| **Group Allowed Users** | List of Open IDs | Only these users can trigger the bot (allowlist mode) |

## Troubleshooting

<AccordionGroup>
  <Accordion title="Bot doesn't receive messages">
    - Verify the app is published and approved
    - Check that `im.message.receive_v1` event is subscribed
    - Make sure WebSocket mode is selected (not HTTP)
    - Verify Encrypt Key and Verification Token match between Feishu console and Claw config
  </Accordion>
  <Accordion title="'app_ticket' error">
    - This usually means the App ID or App Secret is incorrect
    - Double-check the credentials in your dashboard
  </Accordion>
</AccordionGroup>
