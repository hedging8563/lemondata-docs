---
title: "Feishu / Lark"
description: "Connectez votre instance Claw à Feishu (Lark) en utilisant les événements WebSocket"
---

Connectez Feishu (飞书) ou Lark à votre instance Claw. Utilise le mode WebSocket — aucune URL de rappel publique n'est nécessaire.

## Prérequis

- Un compte [Feishu](https://www.feishu.cn/) ou [Lark](https://www.larksuite.com/) avec un accès développeur
- Une instance Claw ([créez-en une ici](https://lemondata.cc/dashboard/claw))

## Guide de configuration

<Steps>
  <Step title="Créer une application Feishu">
    1. Allez sur la [Feishu Open Platform](https://open.feishu.cn/app) (ou [Lark Developer](https://open.larksuite.com/app))
    2. Cliquez sur **Create Custom App**
    3. Saisissez un nom et une description pour l'application
    4. Cliquez sur **Create**
  </Step>
  <Step title="Ajouter la fonctionnalité Bot">
    1. Dans les paramètres de votre application, allez dans **Features** → **Bot**
    2. Activez la fonctionnalité bot
    3. Cela permet à votre application de recevoir et d'envoyer des messages
  </Step>
  <Step title="Obtenir les identifiants">
    1. Allez dans **Credentials & Basic Info**
    2. Copiez l'**App ID** (commence par `cli_`)
    3. Copiez l'**App Secret**
  </Step>
  <Step title="Configurer l'abonnement aux événements">
    1. Allez dans **Event Subscriptions**
    2. Sélectionnez le mode **WebSocket** (recommandé — aucune URL publique nécessaire)
    3. Si on vous le demande, définissez l'**Encrypt Key** et le **Verification Token**

    <Tip>
    Lorsque vous configurez Feishu dans le tableau de bord LemonData, l'**Encrypt Key** et le **Verification Token** sont générés automatiquement pour vous. Copiez ces valeurs dans la console développeur Feishu.
    </Tip>
  </Step>
  <Step title="Ajouter les permissions d'événement">
    1. Sous Event Subscriptions, ajoutez ces événements :
       - `im.message.receive_v1` — Recevoir des messages
    2. Allez dans **Permissions & Scopes** et ajoutez :
       - `im:message` — Envoyer et recevoir des messages
       - `im:message.group_at_msg` — Recevoir les @mentions de groupe
    3. Cliquez sur **Save**
  </Step>
  <Step title="Publier l'application">
    1. Allez dans **App Release** → **Version Management**
    2. Créez une nouvelle version
    3. Soumettez pour révision (pour les applications internes, c'est généralement instantané)
    4. Une fois approuvée, l'application est en ligne
  </Step>
  <Step title="Configurer dans le tableau de bord LemonData">
    1. Allez sur votre [Claw Dashboard](https://lemondata.cc/dashboard/claw)
    2. Cliquez sur l'**icône des paramètres** de votre instance
    3. Ouvrez l'onglet **IM Integrations**
    4. Développez la section **Feishu**
    5. Collez votre **App ID** et votre **App Secret**
    6. Copiez l'**Encrypt Key** et le **Verification Token** générés automatiquement dans la console développeur Feishu
    7. Cliquez sur **Save**
  </Step>
  <Step title="Commencer à discuter">
    1. Dans Feishu, recherchez votre bot par son nom
    2. Envoyez-lui un message
    3. Le premier utilisateur est **automatiquement associé** en tant que propriétaire — aucun code n'est nécessaire !
    4. Commencez à discuter avec l'IA !
  </Step>
</Steps>

## Paramètres de groupe

Configurez le comportement du chat de groupe dans l'onglet **IM Integrations** de votre tableau de bord :

| Paramètre | Options | Description |
|---------|---------|-------------|
| **Group Policy** | Open (par défaut) / Allowlist / Disabled | Contrôle qui peut déclencher le bot dans les groupes |
| **Require @mention** | On / Off | Le bot ne répond que lorsqu'il est @mentionné |
| **Group IDs** | Liste des IDs de chat | Restreindre à des groupes spécifiques (vide = tous les groupes) |
| **Group Allowed Users** | Liste d'Open IDs | Seuls ces utilisateurs peuvent déclencher le bot (mode allowlist) |

## Dépannage

<AccordionGroup>
  <Accordion title="Le bot ne reçoit pas de messages">
    - Vérifiez que l'application est publiée et approuvée
    - Vérifiez que l'événement `im.message.receive_v1` est souscrit
    - Assurez-vous que le mode WebSocket est sélectionné (pas HTTP)
    - Vérifiez que l'Encrypt Key et le Verification Token correspondent entre la console Feishu et la configuration Claw
  </Accordion>
  <Accordion title="Erreur 'app_ticket'">
    - Cela signifie généralement que l'App ID ou l'App Secret est incorrect
    - Vérifiez à nouveau les identifiants dans votre tableau de bord
  </Accordion>
</AccordionGroup>