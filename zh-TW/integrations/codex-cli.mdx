---
title: "Codex CLI"
description: "設定 OpenAI Codex CLI 以使用 LemonData API"
---

## 概覽

OpenAI Codex 是一款開源的命令列工具 (CLI)，作為輕量級的程式碼代理 (coding agent)，能夠在終端機中讀取、修改及執行程式碼。它基於 GPT 模型構建，並針對程式碼生成進行了優化。

## 系統需求

- **作業系統**：macOS, Linux (官方支援), Windows 透過 WSL
- **Node.js**：版本 18+
- **npm**：版本 10.x.x 或更高

## 安裝

```bash
sudo npm install -g @openai/codex@latest
```

驗證安裝：

```bash
codex --version
```

## 配置

### 步驟 1：設定 API Key

**臨時（目前工作階段）：**

```bash
export OPENAI_API_KEY="sk-your-lemondata-key"
```

**永久配置：**

新增至 `~/.bashrc`, `~/.zshrc`, 或 `~/.bash_profile`：

```bash
export OPENAI_API_KEY="sk-your-lemondata-key"
```

接著重新載入：

```bash
source ~/.zshrc  # 或 source ~/.bashrc
```

### 步驟 2：配置 config.toml

編輯 `~/.codex/config.toml`：

```toml
model = "gpt-4o"
model_provider = "lemondata"

[model_providers.lemondata]
name = "LemonData"
base_url = "https://api.lemondata.cc/v1"
env_key = "OPENAI_API_KEY"
wire_api = "chat"
```

<Note>
如果配置檔案不存在，請執行一次 `codex` 以生成檔案，然後再進行編輯。
</Note>

## 基本用法

**啟動互動模式：**

```bash
codex
```

**直接指令：**

```bash
codex "Fix the bug in main.py line 42"
```

**指定模型：**

```bash
codex -m gpt-4o "Build a REST API server"
```

## 可用模型

| 模型 | 適用場景 |
|-------|----------|
| `gpt-4o` | 複雜的編碼任務、架構設計 |
| `gpt-4o-mini` | 快速修復、簡單任務 |
| `claude-sonnet-4-5` | 程式碼審查、文件撰寫 |
| `deepseek-r1` | 演算法設計、推理 |

## 互動指令

| 指令 | 描述 |
|---------|-------------|
| `/help` | 顯示說明 |
| `/exit` 或 `Ctrl+C` | 退出 |
| `/clear` | 清除對話 |
| `/config` | 查看配置 |
| `/model <name>` | 切換模型 |
| `/tokens` | 查看 token 使用量 |

## 驗證配置

```bash
# 檢查環境變數
echo $OPENAI_API_KEY

# 測試 API 連線
codex "Hello, Codex!"

# 查看配置
cat ~/.codex/config.toml
```

## 常見使用案例

**程式碼審查：**

```bash
git diff | codex "Review these code changes"
```

**生成 commit 訊息：**

```bash
git diff --staged | codex "Generate a commit message for these changes"
```

**修復錯誤：**

```bash
codex "Fix the TypeScript errors in src/components/"
```

**解釋程式碼：**

```bash
cat main.py | codex "Explain what this code does"
```

## 故障排除

<AccordionGroup>
  <Accordion title="連線錯誤">
    - 驗證 config.toml 中的 `base_url` 是否準確為 `https://api.lemondata.cc/v1`
    - 檢查網路連線狀態
    - 確保無代理伺服器干擾
  </Accordion>

  <Accordion title="身份驗證失敗">
    - 驗證 `OPENAI_API_KEY` 環境變數已設定
    - 檢查金鑰是否以 `sk-` 開頭
    - 確保金鑰在 LemonData 控制面板中處於啟用狀態
  </Accordion>

  <Accordion title="找不到模型">
    - 檢查模型名稱是否完全符合
    - 在 [lemondata.cc/en/models](https://lemondata.cc/zh-TW/models) 驗證模型可用性
  </Accordion>
</AccordionGroup>