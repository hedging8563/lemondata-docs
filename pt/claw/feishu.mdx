---
title: "Feishu / Lark"
description: "Conecte sua instância Claw ao Feishu (Lark) usando eventos WebSocket"
---

Conecte o Feishu (飞书) ou Lark à sua instância Claw. Utiliza o modo WebSocket — sem necessidade de uma URL de callback pública.

## Pré-requisitos

- Uma conta [Feishu](https://www.feishu.cn/) ou [Lark](https://www.larksuite.com/) com acesso de desenvolvedor
- Uma instância Claw ([crie uma aqui](https://lemondata.cc/dashboard/claw))

## Guia de Configuração

<Steps>
  <Step title="Criar um App Feishu">
    1. Acesse a [Feishu Open Platform](https://open.feishu.cn/app) (ou [Lark Developer](https://open.larksuite.com/app))
    2. Clique em **Create Custom App**
    3. Insira um nome e descrição para o app
    4. Clique em **Create**
  </Step>
  <Step title="Adicionar Capacidade de Bot">
    1. Nas configurações do seu app, vá em **Features** → **Bot**
    2. Ative a capacidade de bot
    3. Isso permite que seu app receba e envie mensagens
  </Step>
  <Step title="Obter Credenciais">
    1. Vá em **Credentials & Basic Info**
    2. Copie o **App ID** (começa com `cli_`)
    3. Copie o **App Secret**
  </Step>
  <Step title="Configurar Assinatura de Eventos">
    1. Vá em **Event Subscriptions**
    2. Selecione o modo **WebSocket** (recomendado — sem necessidade de URL pública)
    3. Se solicitado, defina a **Encrypt Key** e o **Verification Token**

    <Tip>
    Ao configurar o Feishu no painel da LemonData, a Encrypt Key e o Verification Token são **gerados automaticamente** para você. Copie esses valores para o console de desenvolvedor do Feishu.
    </Tip>
  </Step>
  <Step title="Adicionar Permissões de Evento">
    1. Em Event Subscriptions, adicione estes eventos:
       - `im.message.receive_v1` — Receber mensagens
    2. Vá em **Permissions & Scopes** e adicione:
       - `im:message` — Enviar e receber mensagens
       - `im:message.group_at_msg` — Receber @menções em grupo
    3. Clique em **Save**
  </Step>
  <Step title="Publicar o App">
    1. Vá em **App Release** → **Version Management**
    2. Crie uma nova versão
    3. Envie para revisão (para apps internos, isso geralmente é instantâneo)
    4. Uma vez aprovado, o app estará ativo
  </Step>
  <Step title="Configurar no Painel da LemonData">
    1. Vá para o seu [Claw Dashboard](https://lemondata.cc/dashboard/claw)
    2. Clique no **ícone de configurações** da sua instância
    3. Abra a aba **IM Integrations**
    4. Expanda a seção **Feishu**
    5. Cole seu **App ID** e **App Secret**
    6. Copie a **Encrypt Key** e o **Verification Token** gerados automaticamente de volta para o console de desenvolvedor do Feishu
    7. Clique em **Save**
  </Step>
  <Step title="Começar a Conversar">
    1. No Feishu, pesquise pelo seu bot pelo nome
    2. Envie uma mensagem para ele
    3. Conclua o processo de pareamento
    4. Comece a conversar com a IA!
  </Step>
</Steps>

## Configurações de Grupo

Configure o comportamento do chat em grupo na aba **IM Integrations** do seu Dashboard:

| Configuração | Opções | Descrição |
|---------|---------|-------------|
| **Group Policy** | Open (padrão) / Allowlist / Disabled | Controla quem pode acionar o bot em grupos |
| **Require @mention** | On / Off | O bot só responde quando @mencionado |
| **Group IDs** | Lista de IDs de chat | Restringir a grupos específicos (vazio = todos os grupos) |
| **Group Allowed Users** | Lista de Open IDs | Apenas estes usuários podem acionar o bot (modo allowlist) |

## Solução de Problemas

<AccordionGroup>
  <Accordion title="O bot não recebe mensagens">
    - Verifique se o app está publicado e aprovado
    - Verifique se o evento `im.message.receive_v1` está assinado
    - Certifique-se de que o modo WebSocket está selecionado (não HTTP)
    - Verifique se a Encrypt Key e o Verification Token coincidem entre o console do Feishu e a configuração do Claw
  </Accordion>
  <Accordion title="Erro 'app_ticket'">
    - Isso geralmente significa que o App ID ou App Secret está incorreto
    - Verifique novamente as credenciais no seu painel
  </Accordion>
</AccordionGroup>