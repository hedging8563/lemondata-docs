---
title: "Codex CLI"
description: "配置 OpenAI Codex CLI 以使用 LemonData API"
---

## 概览

OpenAI Codex 是一款开源的命令行工具 (CLI)，作为轻量级的代码代理 (coding agent)，能够在终端中读取、修改及执行代码。它基于 GPT 模型构建，并针对代码生成进行了优化。

## 系统要求

- **操作系统**：macOS, Linux (官方支持), Windows 通过 WSL
- **Node.js**：版本 18+
- **npm**：版本 10.x.x 或更高

## 安装

```bash
sudo npm install -g @openai/codex@latest
```

验证安装：

```bash
codex --version
```

## 配置

### 步骤 1：设置 API Key

**临时（当前会话）：**

```bash
export OPENAI_API_KEY="sk-your-lemondata-key"
```

**永久配置：**

添加至 `~/.bashrc`, `~/.zshrc`, 或 `~/.bash_profile`：

```bash
export OPENAI_API_KEY="sk-your-lemondata-key"
```

接着重新加载：

```bash
source ~/.zshrc  # 或 source ~/.bashrc
```

### 步骤 2：配置 config.toml

编辑 `~/.codex/config.toml`：

```toml
model = "gpt-4o"
model_provider = "lemondata"

[model_providers.lemondata]
name = "LemonData"
base_url = "https://api.lemondata.cc/v1"
env_key = "OPENAI_API_KEY"
wire_api = "chat"
```

<Note>
如果配置文件不存在，请执行一次 `codex` 以生成文件，然后再进行编辑。
</Note>

## 基本用法

**启动交互模式：**

```bash
codex
```

**直接指令：**

```bash
codex "Fix the bug in main.py line 42"
```

**指定模型：**

```bash
codex -m gpt-4o "Build a REST API server"
```

## 可用模型

| 模型 | 适用场景 |
|-------|----------|
| `gpt-4o` | 复杂的编码任务、架构设计 |
| `gpt-4o-mini` | 快速修复、简单任务 |
| `claude-sonnet-4-5` | 代码审查、文档撰写 |
| `deepseek-r1` | 算法设计、推理 |

## 交互指令

| 指令 | 描述 |
|---------|-------------|
| `/help` | 显示说明 |
| `/exit` 或 `Ctrl+C` | 退出 |
| `/clear` | 清除对话 |
| `/config` | 查看配置 |
| `/model <name>` | 切换模型 |
| `/tokens` | 查看 token 使用量 |

## 验证配置

```bash
# 检查环境变量
echo $OPENAI_API_KEY

# 测试 API 连接
codex "Hello, Codex!"

# 查看配置
cat ~/.codex/config.toml
```

## 常见使用案例

**代码审查：**

```bash
git diff | codex "Review these code changes"
```

**生成 commit 信息：**

```bash
git diff --staged | codex "Generate a commit message for these changes"
```

**修复错误：**

```bash
codex "Fix the TypeScript errors in src/components/"
```

**解释代码：**

```bash
cat main.py | codex "Explain what this code does"
```

## 故障排除

<AccordionGroup>
  <Accordion title="连接错误">
    - 验证 config.toml 中的 `base_url` 是否准确为 `https://api.lemondata.cc/v1`
    - 检查网络连接状态
    - 确保无代理服务器干扰
  </Accordion>

  <Accordion title="身份验证失败">
    - 验证 `OPENAI_API_KEY` 环境变量已设置
    - 检查密钥是否以 `sk-` 开头
    - 确保密钥在 LemonData 控制面板中处于启用状态
  </Accordion>

  <Accordion title="找不到模型">
    - 检查模型名称是否完全符合
    - 在 [lemondata.cc/en/models](https://lemondata.cc/zh-TW/models) 验证模型可用性
  </Accordion>
</AccordionGroup>