---
title: "DingTalk"
description: "使用 Stream 模式将您的 Claw 实例连接到钉钉"
---

使用 Stream 模式将钉钉 (DingTalk) 连接到您的 Claw 实例 —— 这是一种基于 WebSocket 的连接方式，不需要公网 URL。

## 先决条件

- 一个具有企业管理员权限的 [钉钉](https://www.dingtalk.com/) 账号
- 一个 Claw 实例 ([在此处创建](https://lemondata.cc/dashboard/claw))

## 设置指南

<Steps>
  <Step title="创建钉钉应用">
    1. 前往 [钉钉开放平台](https://open-dev.dingtalk.com/)
    2. 点击 **应用开发** → **企业内部开发**
    3. 点击 **创建应用**
    4. 输入应用名称和描述
    5. 点击 **确定**
  </Step>
  <Step title="启用机器人能力">
    1. 在您的应用中，前往 **应用能力** → **机器人**
    2. 启用机器人配置
    3. 选择 **Stream 模式** (推荐 —— 不需要公网 URL)
    4. 点击 **发布**

    <Tip>
    Stream 模式使用 WebSocket，因此您的 Claw 实例不需要公网可访问的 webhook URL。这是最简单的设置方式。
    </Tip>
  </Step>
  <Step title="获取凭据">
    1. 前往 **基础信息** → **凭据与基础信息**
    2. 复制 **AppKey** 和 **AppSecret**
  </Step>
  <Step title="发布应用">
    1. 前往 **版本管理与发布**
    2. 创建一个新版本 (至少是测试版本)
    3. 设置可见范围 (哪些用户/部门可以看到该机器人)
    4. 提交并发布
  </Step>
  <Step title="在 LemonData 控制面板中配置">
    1. 前往您的 [Claw Dashboard](https://lemondata.cc/dashboard/claw)
    2. 点击您实例上的 **设置图标**
    3. 打开 **IM Integrations** 标签页
    4. 展开 **DingTalk** 部分
    5. 粘贴您的 **AppKey** 和 **AppSecret**
    6. 点击 **Save**
  </Step>
  <Step title="开始聊天">
    1. 在钉钉中，通过名称搜索您的机器人
    2. 向它发送一条消息
    3. 第一个用户将 **自动配对** 为所有者 —— 无需代码！
    4. 开始与 AI 聊天！
  </Step>
</Steps>

## 群组设置

在控制面板的 **IM Integrations** 标签页中配置群聊行为：

| 设置 | 选项 | 描述 |
|---------|---------|-------------|
| **Group Policy** | Open (默认) / Allowlist / Disabled | 控制谁可以在群组中触发机器人 |
| **Group Allowed Users** | 用户 ID 列表 | 仅这些用户可以触发机器人 (白名单模式) |

<Note>
钉钉在群组中触发机器人 **始终需要 @提及** —— 这是平台限制，无法配置。钉钉不支持群组 ID 过滤；请使用 Group Policy 设置来控制访问权限。
</Note>

## 故障排除

<AccordionGroup>
  <Accordion title="机器人没有响应">
    - 验证 AppKey 和 AppSecret 是否正确
    - 检查应用是否已发布 (至少是测试版本)
    - 确保在机器人配置中选择了 Stream 模式
    - 验证机器人对您的用户账号可见
  </Accordion>
  <Accordion title="连接频繁断开">
    - Stream 模式维持一个持久的 WebSocket 连接
    - 短暂的断开连接是正常的 —— 机器人会自动重新连接
    - 如果问题持续存在，请尝试从控制面板重启实例
  </Accordion>
</AccordionGroup>