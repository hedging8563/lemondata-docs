---
title: "OpenCode"
description: "配置 OpenCode 以使用 LemonData API"
---

## 概览

OpenCode 是一款在终端运行的开源 AI 编程助手。它支持多个 LLM 提供商，并可配置使用 LemonData 的 API 以访问 300 多种模型。

## 安装

<Tabs>
  <Tab title="安装脚本">
    ```bash
    curl -fsSL https://opencode.ai/install | bash
    ```
  </Tab>
  <Tab title="Homebrew">
    ```bash
    brew install opencode-ai/tap/opencode
    ```

    或者使用社区 tap（更新更频繁）：
    ```bash
    brew install anomalyco/tap/opencode
    ```
  </Tab>
  <Tab title="Go">
    ```bash
    go install github.com/opencode-ai/opencode@latest
    ```
  </Tab>
</Tabs>

验证安装：

```bash
opencode --version
```

## 配置

### 步骤 1：设置环境变量

```bash
export OPENAI_API_KEY="sk-your-lemondata-key"
export LOCAL_ENDPOINT="https://api.lemondata.cc/v1"
```

如需永久配置，请添加到 `~/.bashrc` 或 `~/.zshrc`：

```bash
echo 'export OPENAI_API_KEY="sk-your-lemondata-key"' >> ~/.zshrc
echo 'export LOCAL_ENDPOINT="https://api.lemondata.cc/v1"' >> ~/.zshrc
source ~/.zshrc
```

### 步骤 2：配置 OpenCode

在项目根目录下创建或编辑 `~/.config/opencode/opencode.json`（全局）或 `opencode.json`：

```json
{
  "provider": {
    "openai": {
      "options": {
        "apiKey": "sk-your-lemondata-key",
        "baseURL": "https://api.lemondata.cc/v1"
      }
    }
  },
  "model": "gpt-4o",
  "agent": {
    "coder": {
      "model": "gpt-4o"
    }
  }
}
```

## 基本用法

**启动交互模式：**

```bash
opencode
```

**使用提示词运行：**

```bash
opencode "Explain this codebase"
```

**指定模型：**

```bash
opencode --model gpt-4o "Fix the bugs in main.py"
```

## 可用模型

| 模型 | 最适用于 |
|-------|----------|
| `gpt-4o` | 复杂任务、代码架构 |
| `gpt-4o-mini` | 快速修复、简单查询 |
| `claude-sonnet-4-5` | 代码审查、文档编写 |
| `claude-opus-4-5` | 复杂推理 |
| `gemini-2.5-flash` | 快速响应 |
| `deepseek-r1` | 算法设计 |

## 常用命令

**分析代码：**

```bash
opencode "What does this function do?" < src/utils.ts
```

**生成代码：**

```bash
opencode "Create a REST API with Express"
```

**审查更改：**

```bash
git diff | opencode "Review these changes"
```

**修复错误：**

```bash
opencode "Fix the TypeScript errors in this project"
```

## 交互式命令

| 命令 | 描述 |
|---------|-------------|
| `/help` | 显示可用命令 |
| `/model <name>` | 切换到不同的模型 |
| `/clear` | 清除对话历史 |
| `/exit` | 退出 OpenCode |

## 故障排除

<AccordionGroup>
  <Accordion title="连接错误">
    - 验证 `LOCAL_ENDPOINT` 已设置为 `https://api.lemondata.cc/v1`
    - 检查网络连接
    - 尝试使用 `curl https://api.lemondata.cc/v1/models` 进行测试
  </Accordion>

  <Accordion title="身份验证失败">
    - 验证是否已设置 `OPENAI_API_KEY` 环境变量
    - 检查密钥是否以 `sk-` 开头
    - 确保密钥在 LemonData 控制面板中处于激活状态
  </Accordion>

  <Accordion title="未找到模型">
    - 检查配置中的模型名称是否完全匹配
    - 在 [lemondata.cc/en/models](https://lemondata.cc/zh/models) 验证模型的可用性
  </Accordion>
</AccordionGroup>

## 最佳实践

<AccordionGroup>
  <Accordion title="使用项目上下文">
    从项目根目录运行 OpenCode，以便更好地理解您的代码库。
  </Accordion>

  <Accordion title="选择合适的模型">
    对于简单任务使用更快的模型 (`gpt-4o-mini`)，对于复杂任务使用功能强大的模型 (`gpt-4o`, `claude`)。
  </Accordion>

  <Accordion title="审查生成的代码">
    在将更改应用到项目之前，务必审查 AI 生成的代码。
  </Accordion>
</AccordionGroup>