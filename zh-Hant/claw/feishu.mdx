---
title: "Feishu / Lark"
description: "使用 WebSocket 事件將您的 Claw 實例連接到 Feishu (飛書)"
---

將 Feishu (飛書) 或 Lark 連接到您的 Claw 實例。使用 WebSocket 模式 — 無需公開的回調 URL。

## 先決條件

- 一個具有開發者權限的 [Feishu](https://www.feishu.cn/) 或 [Lark](https://www.larksuite.com/) 帳號
- 一個 Claw 實例 ([在此建立](https://lemondata.cc/dashboard/claw))

## 設定指南

<Steps>
  <Step title="建立 Feishu 應用程式">
    1. 前往 [Feishu 開放平台](https://open.feishu.cn/app) (或 [Lark Developer](https://open.larksuite.com/app))
    2. 點擊 **建立自定義應用**
    3. 輸入應用程式名稱和描述
    4. 點擊 **建立**
  </Step>
  <Step title="添加機器人功能">
    1. 在您的應用程式設定中，前往 **添加應用能力** → **機器人**
    2. 啟用機器人功能
    3. 這允許您的應用程式接收和發送訊息
  </Step>
  <Step title="獲取憑證">
    1. 前往 **憑證與基礎資訊**
    2. 複製 **App ID** (以 `cli_` 開頭)
    3. 複製 **App Secret**
  </Step>
  <Step title="配置事件訂閱">
    1. 前往 **事件訂閱**
    2. 選擇 **WebSocket** 模式 (推薦 — 無需公開 URL)
    3. 如果出現提示，請設置 **Encrypt Key** 和 **Verification Token**

    <Tip>
    當您在 LemonData 控制面板中配置 Feishu 時，**Encrypt Key** 和 **Verification Token** 會自動為您生成。請將這些值複製到 Feishu 開發者後台。
    </Tip>
  </Step>
  <Step title="添加事件權限">
    1. 在事件訂閱下，添加以下事件：
       - `im.message.receive_v1` — 接收消息
    2. 前往 **權限管理** 並添加：
       - `im:message` — 發送和接收消息
       - `im:message.group_at_msg` — 接收群組 @ 消息
    3. 點擊 **保存**
  </Step>
  <Step title="發佈應用程式">
    1. 前往 **版本管理與發佈** → **版本管理**
    2. 建立新版本
    3. 提交審核 (對於企業自建應用，這通常是即時的)
    4. 審核通過後，應用程式即正式上線
  </Step>
  <Step title="在 LemonData 控制面板中配置">
    1. 前往您的 [Claw Dashboard](https://lemondata.cc/dashboard/claw)
    2. 點擊實例上的 **設定圖示**
    3. 打開 **IM Integrations** 標籤
    4. 展開 **Feishu** 區塊
    5. 貼上您的 **App ID** 和 **App Secret**
    6. 將自動生成的 **Encrypt Key** 和 **Verification Token** 複製回 Feishu 開發者後台
    7. 點擊 **Save**
  </Step>
  <Step title="開始聊天">
    1. 在 Feishu 中，按名稱搜尋您的機器人
    2. 向它發送訊息
    3. 完成配對流程
    4. 開始與 AI 聊天！
  </Step>
</Steps>

## 疑難排解

<AccordionGroup>
  <Accordion title="機器人收不到訊息">
    - 確認應用程式已發佈並通過審核
    - 檢查是否已訂閱 `im.message.receive_v1` 事件
    - 確保選擇了 WebSocket 模式 (而非 HTTP)
    - 驗證 Feishu 後台與 Claw 配置之間的 Encrypt Key 和 Verification Token 是否一致
  </Accordion>
  <Accordion title="'app_ticket' 錯誤">
    - 這通常意味著 App ID 或 App Secret 不正確
    - 請再次檢查控制面板中的憑證
  </Accordion>
</AccordionGroup>